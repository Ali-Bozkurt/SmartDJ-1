(function(e){function t(t){for(var a,n,o=t[0],c=t[1],l=t[2],u=0,h=[];u<o.length;u++)n=o[u],i[n]&&h.push(i[n][0]),i[n]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(h.length)h.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],a=!0,n=1;n<s.length;n++){var o=s[n];0!==i[o]&&(a=!1)}a&&(r.splice(t--,1),e=c(c.s=s[0]))}return e}var a={},n={app:0},i={app:0},r=[];function o(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-0ca8531c":"225c6928","chunk-177a1e37":"393d8d43","chunk-47e8eefe":"ff524f97","chunk-79f8d383":"e146668c"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,c),s.l=!0,s.exports}c.e=function(e){var t=[],s={"chunk-0ca8531c":1,"chunk-177a1e37":1,"chunk-47e8eefe":1,"chunk-79f8d383":1};n[e]?t.push(n[e]):0!==n[e]&&s[e]&&t.push(n[e]=new Promise(function(t,s){for(var a="css/"+({}[e]||e)+"."+{"chunk-0ca8531c":"2448c324","chunk-177a1e37":"4da1c273","chunk-47e8eefe":"48b12002","chunk-79f8d383":"2d46f4b0"}[e]+".css",n=c.p+a,i=document.getElementsByTagName("link"),r=0;r<i.length;r++){var o=i[r],l=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(l===a||l===n))return t()}var u=document.getElementsByTagName("style");for(r=0;r<u.length;r++){o=u[r],l=o.getAttribute("data-href");if(l===a||l===n)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var a=t&&t.target&&t.target.src||n,i=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");i.request=a,s(i)},h.href=n;var d=document.getElementsByTagName("head")[0];d.appendChild(h)}).then(function(){n[e]=0}));var a=i[e];if(0!==a)if(a)t.push(a[2]);else{var r=new Promise(function(t,s){a=i[e]=[t,s]});t.push(a[2]=r);var l,u=document.getElementsByTagName("head")[0],h=document.createElement("script");h.charset="utf-8",h.timeout=120,c.nc&&h.setAttribute("nonce",c.nc),h.src=o(e),l=function(t){h.onerror=h.onload=null,clearTimeout(d);var s=i[e];if(0!==s){if(s){var a=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src,r=new Error("Loading chunk "+e+" failed.\n("+a+": "+n+")");r.type=a,r.request=n,s[1](r)}i[e]=void 0}};var d=setTimeout(function(){l({type:"timeout",target:h})},12e4);h.onerror=h.onload=l,u.appendChild(h)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,s){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(s,a,function(t){return e[t]}.bind(null,a));return s},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var h=0;h<l.length;h++)t(l[h]);var d=u;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";var a=s("c21b"),n=s.n(a);n.a},"0785":function(e,t,s){"use strict";var a=s("b400"),n=s.n(a);n.a},"2f94":function(e,t,s){"use strict";var a,n,i,r=s("bc3a"),o=s.n(r);void 0===a?(n="https://spotilize.herokuapp.com",i=""):(n=a.baseURL,i=a.serverPort);var c=n+i+"/spotify",l=()=>{return o.a.create({baseURL:c})};t["a"]={link(){return l().get("/link")},exchange(e){return l().post("/authorize",e)},refreshToken(e){return l().post("/access_token/refresh",{refresh_token:e})},getDevices(e){return l().get(`/devices/${e}`)},startPlayer(){return l().post("/player/open")},play(e){return l().put("/play",e)},pause(e){return l().put("/pause",e)},nextTrack(e){return l().post("/next",e)},previousTrack(e){return l().post("/prev",e)},seek(e){return l().put("/seek",e)},repeat(e){return l().put("/repeat",e)},shuffle(e){return l().put("/shuffle",e)},setVolume(e){return l().put("/volume",e)},getProfile(e){return l().get(`/profile/${e}`)},getCurrentlyPlaying(e){return l().get(`/currently_playing/${e}`)},getRecentlyPlayed(e){return l().get(`/recently_played/${e}`)},getTopArtists(e){return l().get(`/top_artists/${e}`)},getTrackInfo(e,t){return l().get(`/track/${e}/${t}`)},analyzeTrack(e,t){return l().get(`/analyze/${e}/${t}`)},transferDevicePlayer(e){return l().put("/transfer/player",e)},transferDevice(e){return l().put(`/transfer/${e}`)}}},"56d7":function(e,t,s){"use strict";s.r(t);var a=s("2b0e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:{show:e.isShowing},attrs:{id:"app"}},[s("notifications",{staticClass:"notif",attrs:{group:"track"}}),!1===e.landing?s("Hamburger",{staticClass:"controls",class:{show:e.isShowing}}):e._e(),s("router-view"),!1===e.landing?s("div",{staticClass:"controls-wrapper"},[s("Controls",{staticClass:"controls",class:{show:e.isShowing},attrs:{token:e.token,artist:e.artist,album:e.album,track:e.track,paused:e.paused}})],1):e._e()],1)},i=[],r=s("2f94"),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"nav"}},[s("router-link",{attrs:{to:"/visualizer"}},[e._v("Visualizer")]),s("router-link",{attrs:{to:"/system_settings"}},[e._v("System")])],1)},c=[],l={name:"Nav"},u=l,h=(s("919b"),s("2877")),d=Object(h["a"])(u,o,c,!1,null,"0ed971ad",null);d.options.__file="Nav.vue";var p=d.exports,f=s("c75a"),g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"menu"}},[s("input",{staticClass:"input-toggler",attrs:{type:"checkbox",id:"menuToggler"}}),e._m(0),s("aside",{staticClass:"sidebar"},[s("div",{staticClass:"sidebar-content"},[s("h3",[e._v("Spotilize")]),s("span",{staticClass:"sidebar_line"}),s("br"),s("ul",[s("li",[s("b-btn",{attrs:{variant:"link"},on:{click:function(t){e.toggle("music")}}},[e._v("Music")]),s("ul",{staticClass:"submenu",class:{show:e.music}},[s("li",[e._v("Coming Soon")])])],1),s("li",[s("b-btn",{attrs:{variant:"link"},on:{click:function(t){e.toggle("visualizations")}}},[e._v("Visualizations")]),s("ul",{staticClass:"submenu",class:{show:e.visualizations}},[s("li",[e._v("Coming Soon")])])],1),s("li",[s("b-btn",{attrs:{variant:"link"},on:{click:function(t){e.toggle("settings")}}},[e._v("Settings")]),s("ul",{staticClass:"submenu",class:{show:e.settings}},[s("li",[e._v("Coming Soon")])])],1),s("li",[s("b-btn",{attrs:{variant:"link"}},[e._v("About")])],1),s("li",[s("b-btn",{attrs:{variant:"link"},on:{click:function(t){e.logout()}}},[e._v("Logout")])],1)])])])])},m=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("label",{staticClass:"menu-toggler",attrs:{for:"menuToggler"}},[s("span",{staticClass:"menu-toggler__line"}),s("span",{staticClass:"menu-toggler__line"}),s("span",{staticClass:"menu-toggler__line"})])}],k={name:"Menu",data(){return{music:!1,visualizations:!1,settings:!1}},methods:{logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),this.$router.replace({name:"home"})},toggleAllFalseExcept(e){switch(e){case"music":this.visualizations=!1,this.settings=!1;break;case"visualizations":this.music=!1,this.settings=!1;break;case"settings":this.visualizations=!1,this.music=!1}},toggle(e){switch(e){case"music":this.toggleAllFalseExcept("music"),!0===this.music?this.music=!1:this.music=!0;break;case"visualizations":this.toggleAllFalseExcept("visualizations"),!0===this.visualizations?this.visualizations=!1:this.visualizations=!0;break;case"settings":this.toggleAllFalseExcept("settings"),!0===this.settings?this.settings=!1:this.settings=!0;break}}}},v=k,b=(s("7155"),Object(h["a"])(v,g,m,!1,null,"e4462330",null));b.options.__file="Menu.vue";var y=b.exports,_=(s("93bf"),{name:"App",components:{Nav:p,Controls:f["a"],Hamburger:y},data(){return{ext:null,landing:!0,player:null,playerId:"",token:"",artist:"",album:"",prevTrack:"",track:"",trackId:"",paused:!0,refreshIntervalSet:!1,refreshInterval:0,mouseMoveSet:!1,menu:!1,isShowing:!0,timedelay:1,_delay:0,notifyCount:0}},created(){this.$wait.start("loading"),localStorage.access_token&&(chrome.runtime?chrome.runtime.sendMessage("jidcihllhnmbjbnoijfepopdpkpgeobe","version",e=>{e?e.version&&this.$router.replace({name:"visualizer"}):this.$router.replace({name:"home"})}):this.$router.replace({name:"home"}))},mounted(){},sockets:{paused:function(){this.$notify({group:"track",title:this.track+" - PAUSED",text:this.artist})},played:function(){this.$notify({group:"track",title:this.track,text:this.artist})}},watch:{$route(e,t){if("/"===e.path)this.terminateVis();else{if("/success"===e.path)return;if("/visualizer"!==e.path)return;this.initVis()}}},methods:{initVis(){this.landing=!1,this.refreshToken(),""===this.token&&this.getToken(),!1===this.refreshIntervalSet&&(this.createRefreshInterval(),this.refreshIntervalSet=!0),!1===this.mouseMoveSet&&(this._delay=setInterval(this.delayCheck,500),addEventListener("mousemove",this.mouseMove,!1),this.mouseMoveSet=!0),this.webPlayer()},terminateVis(){this.landing=!0,!0===this.refreshIntervalSet&&(clearInterval(this.refreshInterval),this.refreshIntervalSet=!1),!0===this.mouseMoveSet&&(clearInterval(this._delay),removeEventListener("mousemove",this.mouseMove,!1),this.mouseMoveSet=!1),null!==this.player&&(this.player.disconnect(),this.player=null)},async webPlayer(){if(null===this.player){let e=document.createElement("script");e.setAttribute("src","https://sdk.scdn.co/spotify-player.js"),document.head.appendChild(e),window.onSpotifyWebPlaybackSDKReady=(()=>{this.player=new Spotify.Player({name:"Vue Visualizer",getOAuthToken:e=>{this.getToken(),e(this.token)}}),this.player.addListener("initialization_error",({message:e})=>{console.error(e)}),this.player.addListener("authentication_error",({message:e})=>{console.error(e)}),this.player.addListener("account_error",({message:e})=>{console.error(e)}),this.player.addListener("playback_error",({message:e})=>{console.error(e)}),this.player.addListener("player_state_changed",e=>{this.stateChanged(e)}),this.player.addListener("ready",({device_id:e})=>{console.log("Ready with Device ID",e),localStorage.setItem("device_id",e),this.songLoaded=!0,this.playerId=e,this.$socket.emit("ready",{player_id:this.playerId,token:this.token})}),this.player.addListener("not_ready",({device_id:e})=>{localStorage.removeItem("device_id"),this.songLoaded=!1,console.log("Device ID has gone offline",e)}),this.player.connect().then(e=>{e&&console.log("Webplayback SDK successfully connected to Spotify")})})}this.$socket.emit("ready",{player_id:this.playerId,access_token:this.token})},getToken(){localStorage.access_token?(this.token=localStorage.access_token,this.tokenExists=!0):this.tokenExists=!1},async refreshToken(){let e=localStorage.refresh_token;const t=await r["a"].refreshToken(e);if(!0===t.data.success){let e=t.data.access_token;localStorage.setItem("access_token",e),this.token=e,this.$socket.emit("tokenRefreshed",{token:this.token})}},async createRefreshInterval(){this.refreshInterval=setInterval(()=>{this.refreshToken()},6e5)},mouseMove(){this.isShowing=!0,this.timedelay=1,clearInterval(this._delay),this._delay=setInterval(this.delayCheck,500)},toggleMenu(){console.log("menu toggled"),!1===this.menu?this.menu=!0:this.menu=!1},delayCheck(){!0!==this.paused&&!0!==this.menu?(6===this.timedelay&&(this.isShowing=!1,this.timedelay=1),this.timedelay+=1):this.isShowing=!0},stateChanged(e){this.notifyCount>=2&&(this.notifyCount=0),this.prevTrack=this.track,this.track=e.track_window.current_track.name,this.paused=e.paused,this.artist=e.track_window.current_track.artists[0].name+" | "+e.track_window.current_track.album.name,this.notifyCount+=1,!0!==this.paused&&this.notifyCount<2&&this.track!==this.prevTrack&&(this.$notify({group:"track",title:this.track,text:this.artist}),this.trackId=e.track_window.current_track.id),this.$socket.emit("stateChanged",{state:e})}}}),w=_,C=(s("034f"),Object(h["a"])(w,n,i,!1,null,null,null));C.options.__file="App.vue";var S=C.exports,T=s("8c4f");a["default"].use(T["a"]);var x,P,z,$=new T["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:()=>s.e("chunk-79f8d383").then(s.bind(null,"bede"))},{path:"/success",name:"success",component:()=>s.e("chunk-177a1e37").then(s.bind(null,"8345"))},{path:"/system_settings",component:()=>s.e("chunk-47e8eefe").then(s.bind(null,"c66d"))},{path:"/visualizer",name:"visualizer",component:()=>s.e("chunk-0ca8531c").then(s.bind(null,"f3fc"))},{path:"*",redirect:"/"}]}),I=s("43f9"),E=s.n(I),j=(s("51de"),s("9f7b")),M=(s("f9e3"),s("2dd8"),s("5132")),L=s.n(M),A=s("ecee"),O=s("c074"),R=s("ad3d"),D=s("f2d6"),V=s.n(D),F=s("ee98"),N=s.n(F);a["default"].use(V.a),void 0===x?(P="spotilize.herokuapp.com",z=""):(P=x.baseURL,z=x.serverPort),a["default"].use(new L.a({connection:P+z})),a["default"].use(N.a),A["c"].add(O["n"]),A["c"].add(O["b"]),A["c"].add(O["o"]),A["c"].add(O["m"]),A["c"].add(O["l"]),A["c"].add(O["i"]),A["c"].add(O["h"]),A["c"].add(O["j"]),A["c"].add(O["k"]),A["c"].add(O["q"]),A["c"].add(O["p"]),A["c"].add(O["a"]),A["c"].add(O["c"]),A["c"].add(O["f"]),A["c"].add(O["d"]),A["c"].add(O["e"]),A["c"].add(O["g"]),a["default"].component("font-awesome-icon",R["a"]),a["default"].use(j["a"]),a["default"].use(E.a),a["default"].config.productionTip=!1,new a["default"]({router:$,wait:new V.a,render:e=>e(S)}).$mount("#app")},7155:function(e,t,s){"use strict";var a=s("bcba"),n=s.n(a);n.a},"919b":function(e,t,s){"use strict";var a=s("aa39"),n=s.n(a);n.a},aa39:function(e,t,s){},b400:function(e,t,s){},bcba:function(e,t,s){},c21b:function(e,t,s){},c75a:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"controls"}},[s("b-button-toolbar",{attrs:{"aria-label":"Toolbar with button groups"}},[s("b-button-group",{staticClass:"mx-1",attrs:{size:"lg"}},[1===e.repeatToggle?s("b-btn",{staticClass:"invertedPlaybackControls",on:{click:function(t){e.toggleRepeat()}}},[s("font-awesome-icon",{attrs:{icon:"redo"}})],1):e._e(),2===e.repeatToggle?s("b-btn",{staticClass:"halfPlaybackControls",on:{click:function(t){e.toggleRepeat()}}},[s("font-awesome-icon",{attrs:{icon:"redo"}})],1):e._e(),3===e.repeatToggle?s("b-btn",{staticClass:"playbackControls",on:{click:function(t){e.toggleRepeat()}}},[s("font-awesome-icon",{attrs:{icon:"redo"}})],1):e._e(),s("b-btn",{staticClass:"invertedPlaybackControls",on:{click:e.prev}},[s("font-awesome-icon",{attrs:{icon:"step-backward"}})],1)],1),s("b-button-group",{staticClass:"mx-1",attrs:{size:"lg"}},[!0===e.paused?s("b-btn",{staticClass:"invertedPlaybackControls",staticStyle:{"border-radius":"50%"},on:{click:function(t){e.play()}}},[s("font-awesome-icon",{attrs:{icon:"play"}})],1):!1===e.paused?s("b-btn",{staticClass:"playbackControls",staticStyle:{"border-radius":"50%"},on:{click:function(t){e.pause()}}},[s("font-awesome-icon",{attrs:{icon:"pause"}})],1):e._e()],1),s("b-button-group",{staticClass:"mx-1",attrs:{size:"lg"}},[s("b-btn",{staticClass:"invertedPlaybackControls",on:{click:e.next}},[s("font-awesome-icon",{attrs:{icon:"step-forward"}})],1),!1===e.shuffle?s("b-btn",{staticClass:"invertedPlaybackControls",on:{click:function(t){e.toggleShuffle()}}},[s("font-awesome-icon",{attrs:{icon:"random"}})],1):e._e(),!0===e.shuffle?s("b-btn",{staticClass:"playbackControls",on:{click:function(t){e.toggleShuffle()}}},[s("font-awesome-icon",{attrs:{icon:"random"}})],1):e._e()],1),s("b-button-group",{attrs:{size:"lg"}},[!1===e.fullScreen?s("b-btn",{staticClass:"invertedPlaybackControls screen",attrs:{id:"fullscreen"},on:{click:function(t){e.toggleFullScreen()}}},[s("font-awesome-icon",{attrs:{icon:"arrows-alt"}})],1):e._e(),!0===e.fullScreen?s("b-btn",{staticClass:"playbackControls screen",on:{click:function(t){e.toggleFullScreen()}}},[s("font-awesome-icon",{attrs:{icon:"compress-arrows-alt"}})],1):e._e()],1)],1)],1)},n=[],i=s("2f94"),r=(s("93bf"),{name:"Controls",props:{token:String,artist:String,track:String,paused:Boolean},data(){return{shuffle:!1,repeatToggle:1,fullScreen:!1}},mounted(){},methods:{toggleFullScreen(){if(!1===this.fullScreen){var e="fullscreen";this.fullScreen=!0}else{e="maximized";this.fullScreen=!1}var t={type:"fullscreenRequest",data:e};window.postMessage(t,"*")},async play(){const e=await i["a"].play({access_token:this.token});!0===e.data.success&&(this.paused=!1,this.$socket.emit("played"))},async pause(){const e=await i["a"].pause({access_token:this.token});!0===e.data.success&&(this.paused=!0,this.$socket.emit("paused"))},async next(){const e=await i["a"].nextTrack({access_token:this.token});!0===e.data.success&&setTimeout(()=>{this.getCurrentlyPlaying()},300)},async prev(){const e=await i["a"].previousTrack({access_token:this.token});!0===e.data.success&&setTimeout(()=>{this.getCurrentlyPlaying()},300)},async toggleShuffle(){if(!1===this.shuffle){const e=await i["a"].shuffle({shuffle:!0,access_token:this.token});!0===e.data.success&&(this.shuffle=!0)}else{const e=await i["a"].shuffle({shuffle:!1,access_token:this.token});!0===e.data.success&&(this.shuffle=!1)}},async toggleRepeat(){switch(this.repeatToggle){case 1:const e=await i["a"].repeat({type:"track",access_token:this.token});!0===e.data.success&&(this.repeatToggle=2);break;case 2:const t=await i["a"].repeat({type:"context",access_token:this.token});!0===t.data.success&&(this.repeatToggle=3);break;case 3:const s=await i["a"].repeat({type:"off",access_token:this.token});!0===s.data.success&&(this.repeatToggle=1);break}},async getCurrentlyPlaying(){const e=await i["a"].getCurrentlyPlaying(this.token);!1===e.data.is_playing&&null===e.data.body?(this.album="",this.artist="",this.track="",this.paused=!0):(this.album=e.data.object.item.album.name,this.artist=e.data.object.item.album.artists[0].name+" | "+this.album,this.track=e.data.object.item.name,this.paused=!e.data.is_playing)}}}),o=r,c=(s("0785"),s("2877")),l=Object(c["a"])(o,a,n,!1,null,"526e24db",null);l.options.__file="Controls.vue";t["a"]=l.exports}});
//# sourceMappingURL=app.c4f59579.js.map