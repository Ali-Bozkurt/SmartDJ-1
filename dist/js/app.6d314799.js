(function(e){function t(t){for(var s,n,i=t[0],c=t[1],l=t[2],u=0,d=[];u<i.length;u++)n=i[u],r[n]&&d.push(r[n][0]),r[n]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);h&&h(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],s=!0,n=1;n<a.length;n++){var i=a[n];0!==r[i]&&(s=!1)}s&&(o.splice(t--,1),e=c(c.s=a[0]))}return e}var s={},n={app:0},r={app:0},o=[];function i(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-2d626e5c":"c491ae55","chunk-4733da9c":"ca2c9271","chunk-47e8eefe":"ff524f97","chunk-4a8cd030":"5f059c6f"}[e]+".js"}function c(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.e=function(e){var t=[],a={"chunk-2d626e5c":1,"chunk-4733da9c":1,"chunk-47e8eefe":1,"chunk-4a8cd030":1};n[e]?t.push(n[e]):0!==n[e]&&a[e]&&t.push(n[e]=new Promise(function(t,a){for(var s="css/"+({}[e]||e)+"."+{"chunk-2d626e5c":"e75babfd","chunk-4733da9c":"a43ac20e","chunk-47e8eefe":"48b12002","chunk-4a8cd030":"f713375d"}[e]+".css",n=c.p+s,r=document.getElementsByTagName("link"),o=0;o<r.length;o++){var i=r[o],l=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(l===s||l===n))return t()}var u=document.getElementsByTagName("style");for(o=0;o<u.length;o++){i=u[o],l=i.getAttribute("data-href");if(l===s||l===n)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var s=t&&t.target&&t.target.src||n,r=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");r.request=s,a(r)},d.href=n;var h=document.getElementsByTagName("head")[0];h.appendChild(d)}).then(function(){n[e]=0}));var s=r[e];if(0!==s)if(s)t.push(s[2]);else{var o=new Promise(function(t,a){s=r[e]=[t,a]});t.push(s[2]=o);var l,u=document.getElementsByTagName("head")[0],d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=i(e),l=function(t){d.onerror=d.onload=null,clearTimeout(h);var a=r[e];if(0!==a){if(a){var s=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src,o=new Error("Loading chunk "+e+" failed.\n("+s+": "+n+")");o.type=s,o.request=n,a[1](o)}r[e]=void 0}};var h=setTimeout(function(){l({type:"timeout",target:d})},12e4);d.onerror=d.onload=l,u.appendChild(d)}return Promise.all(t)},c.m=e,c.c=s,c.d=function(e,t,a){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)c.d(a,s,function(t){return e[t]}.bind(null,s));return a},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var h=u;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var s=a("c21b"),n=a.n(s);n.a},"0785":function(e,t,a){"use strict";var s=a("b400"),n=a.n(s);n.a},"2f94":function(e,t,a){"use strict";var s,n=a("bc3a"),r=a.n(n);const o=Object({NODE_ENV:"production",BASE_URL:"/"}).baseURL||s.baseURL,i=Object({NODE_ENV:"production",BASE_URL:"/"}).PORT||s.serverPort;var c=()=>{return r.a.create({baseURL:o+i+"/spotify"})};t["a"]={link(){return c().get("/link")},exchange(e){return c().post("/authorize",e)},refreshToken(e){return c().post("/access_token/refresh",{refresh_token:e})},getDevices(e){return c().get(`/devices/${e}`)},startPlayer(){return c().post("/player/open")},play(e){return c().put("/play",e)},pause(e){return c().put("/pause",e)},nextTrack(e){return c().post("/next",e)},previousTrack(e){return c().post("/prev",e)},seek(e){return c().put("/seek",e)},repeat(e){return c().put("/repeat",e)},shuffle(e){return c().put("/shuffle",e)},setVolume(e){return c().put("/volume",e)},getProfile(e){return c().get(`/profile/${e}`)},getCurrentlyPlaying(e){return c().get(`/currently_playing/${e}`)},getRecentlyPlayed(e){return c().get(`/recently_played/${e}`)},getTopArtists(e){return c().get(`/top_artists/${e}`)},getTrackInfo(e,t){return c().get(`/track/${e}/${t}`)},analyzeTrack(e,t){return c().get(`/analyze/${e}/${t}`)},transferDevicePlayer(e){return c().put("/transfer/player",e)},transferDevice(e){return c().put(`/transfer/${e}`)}}},"4d8b":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);var s=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{show:e.isShowing},attrs:{id:"app"}},[a("notifications",{staticClass:"notif",attrs:{group:"track"}}),!1===e.landing?a("Hamburger",{staticClass:"controls",class:{show:e.isShowing}}):e._e(),a("router-view"),!1===e.landing?a("div",{staticClass:"controls-wrapper"},[a("Controls",{staticClass:"controls",class:{show:e.isShowing},attrs:{token:e.token,artist:e.artist,album:e.album,track:e.track,paused:e.paused}})],1):e._e()],1)},r=[],o=a("2f94"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"nav"}},[a("router-link",{attrs:{to:"/visualizer"}},[e._v("Visualizer")]),a("router-link",{attrs:{to:"/system_settings"}},[e._v("System")])],1)},c=[],l={name:"Nav"},u=l,d=(a("919b"),a("2877")),h=Object(d["a"])(u,i,c,!1,null,"0ed971ad",null);h.options.__file="Nav.vue";var f=h.exports,p=a("c75a"),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"menu"}},[a("input",{staticClass:"input-toggler",attrs:{type:"checkbox",id:"menuToggler"}}),e._m(0),a("aside",{staticClass:"sidebar"},[a("div",{staticClass:"sidebar-content"},[a("h3",[e._v("Spotify Visualizer")]),a("span",{staticClass:"sidebar_line"}),a("br"),a("b-btn",{attrs:{variant:"link"}},[e._v("Music")]),a("b-btn",{attrs:{variant:"link"}},[e._v("Visualizations")]),a("b-btn",{attrs:{variant:"link"}},[e._v("Settings")]),a("b-btn",{attrs:{variant:"link"}},[e._v("About")]),a("b-btn",{attrs:{variant:"link"},on:{click:function(t){e.logout()}}},[e._v("Logout")])],1)])])},k=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("label",{staticClass:"menu-toggler",attrs:{for:"menuToggler"}},[a("span",{staticClass:"menu-toggler__line"}),a("span",{staticClass:"menu-toggler__line"}),a("span",{staticClass:"menu-toggler__line"})])}],m={name:"Menu",methods:{logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token");var e={type:"close"};window.postMessage(e,"*")}}},y=m,b=(a("ce7b"),Object(d["a"])(y,g,k,!1,null,"08335700",null));b.options.__file="Menu.vue";var v=b.exports,_=(a("93bf"),{name:"App",components:{Nav:f,Controls:p["a"],Hamburger:v},data(){return{ext:null,landing:!0,player:null,playerId:"",token:"",artist:"",album:"",prevTrack:"",track:"",trackId:"",paused:!0,refreshIntervalSet:!1,refreshInterval:0,mouseMoveSet:!1,isShowing:!0,timedelay:1,_delay:0,notifyCount:0}},created(){this.$wait.start("loading"),localStorage.access_token&&(this.initVis(),this.$router.replace({name:"visualizer"}))},mounted(){},sockets:{paused:function(){this.$notify({group:"track",title:this.track+" - PAUSED",text:this.artist})},played:function(){this.$notify({group:"track",title:this.track,text:this.artist})}},watch:{$route(e,t){if("/"===e.path)this.terminateVis();else{if("/success"===e.path)return;if("/visualizer"!==e.path)return;this.initVis()}}},methods:{initVis(){this.landing=!1,this.refreshToken(),""===this.token&&this.getToken(),!1===this.refreshIntervalSet&&(this.createRefreshInterval(),this.refreshIntervalSet=!0),!1===this.mouseMoveSet&&(this._delay=setInterval(this.delayCheck,500),addEventListener("mousemove",this.mouseMove,!1),this.mouseMoveSet=!0),this.webPlayer()},terminateVis(){this.landing=!0,!0===this.refreshIntervalSet&&(clearInterval(this.refreshInterval),this.refreshIntervalSet=!1),!0===this.mouseMoveSet&&(clearInterval(this._delay),removeEventListener("mousemove",this.mouseMove,!1),this.mouseMoveSet=!1),null!==this.player&&(this.player.disconnect(),this.player=null)},async webPlayer(){if(null===this.player){let e=document.createElement("script");e.setAttribute("src","https://sdk.scdn.co/spotify-player.js"),document.head.appendChild(e),window.onSpotifyWebPlaybackSDKReady=(()=>{this.player=new Spotify.Player({name:"Vue Visualizer",getOAuthToken:e=>{this.getToken(),e(this.token)}}),this.player.addListener("initialization_error",({message:e})=>{console.error(e)}),this.player.addListener("authentication_error",({message:e})=>{console.error(e)}),this.player.addListener("account_error",({message:e})=>{console.error(e)}),this.player.addListener("playback_error",({message:e})=>{console.error(e)}),this.player.addListener("player_state_changed",e=>{this.stateChanged(e)}),this.player.addListener("ready",({device_id:e})=>{console.log("Ready with Device ID",e),localStorage.setItem("device_id",e),this.songLoaded=!0,this.playerId=e,this.$socket.emit("ready",{player_id:this.playerId,token:this.token})}),this.player.addListener("not_ready",({device_id:e})=>{localStorage.removeItem("device_id"),this.songLoaded=!1,console.log("Device ID has gone offline",e)}),this.player.connect().then(e=>{e&&console.log("Webplayback SDK successfully connected to Spotify")})})}this.$socket.emit("ready",{player_id:this.playerId,access_token:this.token})},getToken(){localStorage.access_token?(this.token=localStorage.access_token,this.tokenExists=!0):this.tokenExists=!1},async refreshToken(){let e=localStorage.refresh_token;const t=await o["a"].refreshToken(e);if(!0===t.data.success){let e=t.data.access_token;localStorage.setItem("access_token",e),this.token=e,this.$socket.emit("tokenRefreshed",{token:this.token})}},async createRefreshInterval(){this.refreshInterval=setInterval(()=>{this.refreshToken()},6e5)},mouseMove(){this.isShowing=!0,this.timedelay=1,clearInterval(this._delay),this._delay=setInterval(this.delayCheck,500)},delayCheck(){!0!==this.paused?(4===this.timedelay&&(this.isShowing=!1,this.timedelay=1),this.timedelay+=1):this.isShowing=!0},stateChanged(e){this.notifyCount>=2&&(this.notifyCount=0),this.prevTrack=this.track,this.track=e.track_window.current_track.name,this.paused=e.paused,this.artist=e.track_window.current_track.artists[0].name+" | "+e.track_window.current_track.album.name,this.notifyCount+=1,!0!==this.paused&&this.notifyCount<2&&this.track!==this.prevTrack&&(this.$notify({group:"track",title:this.track,text:this.artist}),this.trackId=e.track_window.current_track.id),this.$socket.emit("stateChanged",{state:e})}}}),w=_,S=(a("034f"),Object(d["a"])(w,n,r,!1,null,null,null));S.options.__file="App.vue";var C=S.exports,T=a("8c4f");s["default"].use(T["a"]);var P,E=new T["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:()=>a.e("chunk-2d626e5c").then(a.bind(null,"bede"))},{path:"/success",name:"success",component:()=>a.e("chunk-4a8cd030").then(a.bind(null,"8345"))},{path:"/system_settings",component:()=>a.e("chunk-47e8eefe").then(a.bind(null,"c66d"))},{path:"/visualizer",name:"visualizer",component:()=>a.e("chunk-4733da9c").then(a.bind(null,"f3fc"))},{path:"*",redirect:"/"}]}),I=a("43f9"),x=a.n(I),$=(a("51de"),a("9f7b")),O=(a("f9e3"),a("2dd8"),a("5132")),j=a.n(O),L=a("ecee"),R=a("c074"),z=a("ad3d"),M=a("f2d6"),A=a.n(M),N=a("ee98"),V=a.n(N);s["default"].use(A.a);const D=Object({NODE_ENV:"production",BASE_URL:"/"}).baseURL||P.baseURL,U=Object({NODE_ENV:"production",BASE_URL:"/"}).PORT||P.serverPort;s["default"].use(new j.a({connection:D+U})),s["default"].use(V.a),L["c"].add(R["m"]),L["c"].add(R["b"]),L["c"].add(R["n"]),L["c"].add(R["l"]),L["c"].add(R["k"]),L["c"].add(R["h"]),L["c"].add(R["g"]),L["c"].add(R["i"]),L["c"].add(R["j"]),L["c"].add(R["p"]),L["c"].add(R["o"]),L["c"].add(R["a"]),L["c"].add(R["c"]),L["c"].add(R["f"]),L["c"].add(R["d"]),L["c"].add(R["e"]),s["default"].component("font-awesome-icon",z["a"]),s["default"].use($["a"]),s["default"].use(x.a),s["default"].config.productionTip=!1,new s["default"]({router:E,wait:new A.a,render:e=>e(C)}).$mount("#app")},"919b":function(e,t,a){"use strict";var s=a("aa39"),n=a.n(s);n.a},aa39:function(e,t,a){},b400:function(e,t,a){},c21b:function(e,t,a){},c75a:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"controls"}},[a("b-button-toolbar",{attrs:{"aria-label":"Toolbar with button groups"}},[a("b-button-group",{staticClass:"mx-1",attrs:{size:"lg"}},[1===e.repeatToggle?a("b-btn",{staticClass:"invertedPlaybackControls",on:{click:function(t){e.toggleRepeat()}}},[a("font-awesome-icon",{attrs:{icon:"redo"}})],1):e._e(),2===e.repeatToggle?a("b-btn",{staticClass:"halfPlaybackControls",on:{click:function(t){e.toggleRepeat()}}},[a("font-awesome-icon",{attrs:{icon:"redo"}})],1):e._e(),3===e.repeatToggle?a("b-btn",{staticClass:"playbackControls",on:{click:function(t){e.toggleRepeat()}}},[a("font-awesome-icon",{attrs:{icon:"redo"}})],1):e._e(),a("b-btn",{staticClass:"invertedPlaybackControls",on:{click:e.prev}},[a("font-awesome-icon",{attrs:{icon:"step-backward"}})],1)],1),a("b-button-group",{staticClass:"mx-1",attrs:{size:"lg"}},[!0===e.paused?a("b-btn",{staticClass:"invertedPlaybackControls",staticStyle:{"border-radius":"50%"},on:{click:function(t){e.play()}}},[a("font-awesome-icon",{attrs:{icon:"play"}})],1):!1===e.paused?a("b-btn",{staticClass:"playbackControls",staticStyle:{"border-radius":"50%"},on:{click:function(t){e.pause()}}},[a("font-awesome-icon",{attrs:{icon:"pause"}})],1):e._e()],1),a("b-button-group",{staticClass:"mx-1",attrs:{size:"lg"}},[a("b-btn",{staticClass:"invertedPlaybackControls",on:{click:e.next}},[a("font-awesome-icon",{attrs:{icon:"step-forward"}})],1),!1===e.shuffle?a("b-btn",{staticClass:"invertedPlaybackControls",on:{click:function(t){e.toggleShuffle()}}},[a("font-awesome-icon",{attrs:{icon:"random"}})],1):e._e(),!0===e.shuffle?a("b-btn",{staticClass:"playbackControls",on:{click:function(t){e.toggleShuffle()}}},[a("font-awesome-icon",{attrs:{icon:"random"}})],1):e._e()],1),a("b-button-group",{attrs:{size:"lg"}},[!1===e.fullScreen?a("b-btn",{staticClass:"invertedPlaybackControls screen",attrs:{id:"fullscreen"},on:{click:function(t){e.toggleFullScreen()}}},[a("font-awesome-icon",{attrs:{icon:"arrows-alt"}})],1):e._e(),!0===e.fullScreen?a("b-btn",{staticClass:"playbackControls screen",on:{click:function(t){e.toggleFullScreen()}}},[a("font-awesome-icon",{attrs:{icon:"compress-arrows-alt"}})],1):e._e()],1)],1)],1)},n=[],r=a("2f94"),o=(a("93bf"),{name:"Controls",props:{token:String,artist:String,track:String,paused:Boolean},data(){return{shuffle:!1,repeatToggle:1,fullScreen:!1}},mounted(){},methods:{toggleFullScreen(){if(!1===this.fullScreen){var e="fullscreen";this.fullScreen=!0}else{e="maximized";this.fullScreen=!1}var t={type:"fullscreenRequest",data:e};window.postMessage(t,"*")},async play(){const e=await r["a"].play({access_token:this.token});!0===e.data.success&&(this.paused=!1,this.$socket.emit("played"))},async pause(){const e=await r["a"].pause({access_token:this.token});!0===e.data.success&&(this.paused=!0,this.$socket.emit("paused"))},async next(){const e=await r["a"].nextTrack({access_token:this.token});!0===e.data.success&&setTimeout(()=>{this.getCurrentlyPlaying()},300)},async prev(){const e=await r["a"].previousTrack({access_token:this.token});!0===e.data.success&&setTimeout(()=>{this.getCurrentlyPlaying()},300)},async toggleShuffle(){if(!1===this.shuffle){const e=await r["a"].shuffle({shuffle:!0,access_token:this.token});!0===e.data.success&&(this.shuffle=!0)}else{const e=await r["a"].shuffle({shuffle:!1,access_token:this.token});!0===e.data.success&&(this.shuffle=!1)}},async toggleRepeat(){switch(this.repeatToggle){case 1:const e=await r["a"].repeat({type:"track",access_token:this.token});!0===e.data.success&&(this.repeatToggle=2);break;case 2:const t=await r["a"].repeat({type:"context",access_token:this.token});!0===t.data.success&&(this.repeatToggle=3);break;case 3:const a=await r["a"].repeat({type:"off",access_token:this.token});!0===a.data.success&&(this.repeatToggle=1);break}},async getCurrentlyPlaying(){const e=await r["a"].getCurrentlyPlaying(this.token);!1===e.data.is_playing&&null===e.data.body?(this.album="",this.artist="",this.track="",this.paused=!0):(this.album=e.data.object.item.album.name,this.artist=e.data.object.item.album.artists[0].name+" | "+this.album,this.track=e.data.object.item.name,this.paused=!e.data.is_playing)}}}),i=o,c=(a("0785"),a("2877")),l=Object(c["a"])(i,s,n,!1,null,"526e24db",null);l.options.__file="Controls.vue";t["a"]=l.exports},ce7b:function(e,t,a){"use strict";var s=a("4d8b"),n=a.n(s);n.a}});
//# sourceMappingURL=app.6d314799.js.map